<!DOCTYPE html>
<html lang="de" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Neue Bestellung</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <style>
        body { font-family: Arial, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Helvetica, sans-serif; margin:0; padding:24px; background:#f6f7f9; color:#222; }
        .card { background:#fff; border-radius:12px; padding:20px; box-shadow:0 2px 10px rgba(0,0,0,.06); max-width:680px; margin:0 auto; }
        h1 { font-size:18px; margin:0 0 12px; }
        .meta { font-size:13px; color:#555; margin-bottom:16px; }
        .addr { background:#fafafa; border:1px solid #eee; border-radius:10px; padding:12px; margin:12px 0; }
        table { width:100%; border-collapse:collapse; }
        th, td { text-align:left; padding:8px 6px; }
        th { font-size:13px; color:#666; border-bottom:1px solid #eee; }
        tr + tr td { border-top:1px dashed #eee; }
        .total { text-align:right; font-weight:600; padding-top:12px; }
        .btn { display:inline-block; margin-top:16px; padding:10px 14px; border-radius:8px; background:#111827; color:#fff !important; text-decoration:none; font-weight:600; }
        .small { font-size:12px; color:#777; margin-top:10px; }
        code { background:#f1f5f9; padding:2px 6px; border-radius:6px; }
    </style>
</head>
<body>
<div class="card">
    <h1>Neue Bestellung <span th:text="'#' + ${order.id}">#123</span></h1>

    <div class="meta">
        Status: <strong th:text="${order.status}">NEW</strong> •
        Erstellt: <strong th:text="${#temporals.format(order.createdAt, 'dd.MM.yyyy HH:mm')}">06.11.2025 17:12</strong>
    </div>

    <div class="addr">
        <div><strong th:text="${order.fullName}">Max Mustermann</strong></div>
        <div>
            <span th:text="${order.street}">Musterstraße 1</span>,
            <span th:text="${order.postalCode}">1010</span>
            <span th:text="${order.city}">Wien</span>,
            <span th:text="${order.country}">AT</span>
        </div>
    </div>

    <table>
        <thead>
        <tr><th>Produkt</th><th>Menge</th><th>Preis</th></tr>
        </thead>
        <tbody>
        <tr th:each="it : ${items}">
            <!-- Falls OrderItem eine Produkt-Relation hat: it.product.name -->
            <td th:text="${it.product != null ? it.product.name : 'Produkt'}">Artikel</td>
            <td th:text="${it.quantity}">1</td>
            <!-- Preisfeld: benutze priceCents ODER priceAtPurchaseCents (was du hast) -->
            <td th:text="${#numbers.formatDecimal(((it.priceAtPurchaseCents != null ? it.priceAtPurchaseCents : (it.priceCents != null ? it.priceCents : 0)) / 100.0), 1, 'DEFAULT', 2, 'DEFAULT')} + ' €'">9,99 €</td>
        </tr>
        </tbody>
    </table>

    <div class="total">
        Gesamt: <span th:text="${#numbers.formatDecimal((order.totalCents != null ? order.totalCents : 0) / 100.0, 1, 'DEFAULT', 2, 'DEFAULT')} + ' €'">59,99 €</span>
    </div>

    <a class="btn" th:href="${adminOrderUrl}">Zu den Admin-Bestellungen</a>
    <div class="small">
        ID: <code th:text="${order.id}">123</code>
    </div>
</div>
</body>
</html>