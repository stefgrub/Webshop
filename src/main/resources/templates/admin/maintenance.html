<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="de">
<head th:replace="~{layout :: head('Wartungsmodus')}"></head>
<body>
<header th:replace="~{layout :: header}"></header>

<main class="container py-4">
    <div th:if="${param.ok}" class="alert alert-success mb-3">
        Einstellungen gespeichert.
    </div>

    <h1 class="mb-3">Wartungsmodus</h1>

    <div class="card p-3 mb-4">
        <p class="mb-3">
            Aktueller Status:
            <strong th:text="${m.enabled} ? 'Aktiv' : 'Inaktiv'">Inaktiv</strong>
        </p>

        <form th:action="@{/admin/maintenance}" method="post" class="grid gap-3">
            <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>

            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="enabled" name="enabled"
                       th:checked="${m.enabled}"/>
                <label class="form-check-label" for="enabled">Wartungsmodus aktivieren</label>
            </div>

            <div>
                <label class="form-label" for="message">Hinweistext</label>
                <textarea class="form-control" id="message" name="message" rows="3"
                          th:text="${m.message}">Wir sind gleich wieder da.</textarea>
            </div>

            <div>
                <label class="form-label" for="end">Ende (ISO-8601)</label>
                <!-- Wenn du 'datetime-local' willst, musst du serverseitig das Format ohne 'Z' liefern -->
                <input class="form-control" id="end" name="end" type="text"
                       placeholder="z. B. 2025-11-30T23:59:00Z"
                       th:value="${m.end}"/>
                <small class="text-muted">Leer lassen, wenn offen.</small>
            </div>

            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="homepageOnly" name="homepageOnly"
                       th:checked="${m.homepageOnly}"/>
                <label class="form-check-label" for="homepageOnly">Nur Startseite blockieren</label>
            </div>

            <div>
                <label class="form-label" for="audience">Zielgruppe</label>
                <select class="form-select" id="audience" name="audience" th:value="${m.audience}">
                    <option value="ALL">Alle</option>
                    <option value="LOGGED_IN">Nur eingeloggte Nutzer</option>
                    <option value="ANONYMOUS">Nur anonyme Nutzer</option>
                </select>
            </div>

            <div>
                <label class="form-label" for="level">Level (0–5)</label>
                <input class="form-control" id="level" name="level" type="number" min="0" max="5"
                       th:value="${m.level}"/>
            </div>
            <div class="d-flex gap-2 mt-2">
                <button class="btn btn-primary" type="submit">Speichern</button>
                <a class="btn btn-secondary" th:href="@{/admin}">Abbrechen</a>
            </div>
        </form>
    </div>

    <section class="card p-3">
        <h2 class="h5 mb-3">Vorschau</h2>
        <p th:text="${m.message}">Wir sind gleich wieder da.</p>
        <dl class="row">
            <dt class="col-sm-3">Ende</dt>
            <dd class="col-sm-9" th:text="${#strings.isEmpty(m.end) ? '—' : m.end}">—</dd>

            <dt class="col-sm-3">Zielgruppe</dt>
            <dd class="col-sm-9" th:text="${m.audience}">ALL</dd>

            <dt class="col-sm-3">Level</dt>
            <dd class="col-sm-9" th:text="${m.level}">0</dd>

            <dt class="col-sm-3">Nur Startseite</dt>
            <dd class="col-sm-9" th:text="${m.homepageOnly} ? 'Ja' : 'Nein'">Nein</dd>

            <dt class="col-sm-3">Link</dt>
            <dd class="col-sm-9">
                <a th:if="${m.link}" th:href="${m.link}" th:text="${m.link}" target="_blank" rel="noopener">Link</a>
                <span th:if="${!m.link}">—</span>
            </dd>
        </dl>
    </section>
</main>

<footer th:replace="~{layout :: footer}"></footer>
</body>
</html>