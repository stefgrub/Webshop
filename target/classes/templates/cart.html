<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="de">
<head th:replace="~{fragments :: head('Warenkorb')}"></head>
<body>
<header th:replace="~{fragments :: header}"></header>
<main class="container">
    <h1>ðŸ›’ Dein Warenkorb</h1>
    <div class="empty" th:if="${#lists.isEmpty(lines)}">
        Dein Warenkorb ist leer.
        <a th:href="@{/}" class="btn secondary">Produkte ansehen</a>
    </div>
    <table class="table glass" style="margin-top:10px;" th:if="${!#lists.isEmpty(lines)}">
        <thead>
        <tr>
            <th>Produkt</th>
            <th>Preis</th>
            <th>Menge</th>
            <th>Summe</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="e : ${lines.entrySet()}">
            <td>
                <a th:href="@{'/p/' + ${e.key.slug}}" th:text="${e.key.name}">Produkt</a>
            </td>
            <td th:text="${#numbers.formatDecimal(e.key.priceCents/100.0,1,'COMMA',2,'POINT')} + ' â‚¬'">
                0,00 â‚¬
            </td>
            <td>
                <form th:action="@{'/cart/update/' + ${e.key.id}}" method="post" class="inline">
                    <input type="number" name="qty" min="0" th:value="${e.value}" />
                    <input type="hidden" name="_csrf" th:if="${_csrf != null}" th:value="${_csrf?.token}" />
                    <button type="submit">Update</button>
                </form>
            </td>
            <td th:text="${#numbers.formatDecimal((e.key.priceCents * e.value)/100.0,1,'COMMA',2,'POINT')} + ' â‚¬'">
                0,00 â‚¬
            </td>
            <td>
                <form th:action="@{'/cart/update/' + ${e.key.id}}" method="post" class="inline">
                    <input type="hidden" name="qty" value="0" />
                    <input type="hidden" name="_csrf" th:if="${_csrf != null}" th:value="${_csrf?.token}" />
                    <button type="submit" class="ghost">Entfernen</button>
                </form>
            </td>
        </tr>
        </tbody>
        <tfoot>
        <tr>
            <th colspan="3" style="text-align:right">Gesamt:</th>
            <th th:text="${#numbers.formatDecimal(totalCents/100.0,1,'COMMA',2,'POINT')} + ' â‚¬'">0,00 â‚¬</th>
            <th></th>
        </tr>
        </tfoot>
    </table>
    <div class="actions" th:if="${!#lists.isEmpty(lines)}" style="margin-top:20px;">
        <a class="btn primary" th:href="@{/checkout}"><span>Zur Kasse</span></a>
        <form th:action="@{/cart/clear}" method="post" class="inline">
            <input type="hidden" name="_csrf" th:if="${_csrf != null}" th:value="${_csrf?.token}" />
            <button  type="submit" class="btn ghost">Leeren</button>
        </form>
    </div>
</main>
<footer th:replace="~{fragments :: footer}"></footer>
</body>
</html>
